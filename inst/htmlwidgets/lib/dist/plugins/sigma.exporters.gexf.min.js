(function(a){"use strict";function b(a,b,c){var d=null,e=null,f=null;if(window.Blob?(d=new Blob([a],{type:"text/xml"}),e=window.URL.createObjectURL(d)):f="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(a),navigator.msSaveBlob)navigator.msSaveBlob(d,c);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(d,c);else{var g=document.createElement("a");g.setAttribute("href",window.Blob?e:f),g.setAttribute("download",c||"graph."+b),document.body.appendChild(g),g.click(),document.body.removeChild(g)}e&&setTimeout(function(){window.URL.revokeObjectURL(e)},0)}function c(a,b){return null===b?null:b.split(".").reduce(function(a,b){return a[b]},a)}function d(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]:null}function e(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();return 10>b&&(b="0"+b),10>c&&(c="0"+c),d+"-"+c+"-"+b}function f(a){return a===+a&&a===(0|a)}function g(a,b){return"integer"===b&&"number"==typeof a?f(a)||(b="float"):"number"!=typeof a&&(b="string","boolean"==typeof a&&(b="boolean")),b}if("undefined"==typeof sigma)throw"sigma.exporters.gexf: sigma is not declared";sigma.prototype.toGEXF=function(a){a=a||{};var f,h=document.implementation.createDocument("","",null),i=new XMLSerializer,j="",k=!0,l=this.graph.nodes(),m=this.graph.edges();a.renderer&&(k=a.renderer instanceof sigma.renderers.webgl,f=k?a.renderer.camera.prefix:a.renderer.camera.readPrefix);var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H={},I=0,J={},K=0;D=h.createElement("gexf"),D.setAttribute("xmlns","http://www.gexf.net/1.2draft"),D.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),D.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),D.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),D.setAttribute("version","1.2"),A=h.createElement("meta"),A.setAttribute("lastmodifieddate",e()),a.creator&&(v=h.createElement("creator"),G=h.createTextNode(""+a.creator),v.appendChild(G),A.appendChild(v)),a.description&&(w=h.createElement("description"),G=h.createTextNode(""+a.description),w.appendChild(G),A.appendChild(w)),z=h.createElement("graph"),z.setAttribute("mode","static"),B=h.createElement("nodes");for(var L=0;L<l.length;L++){if(n=l[L],C=h.createElement("node"),C.setAttribute("id",n.id),n.label&&C.setAttribute("label",n.label),o=c(n,a.nodeAttributes),o&&(q=h.createElement("attvalues"),Object.keys(o).forEach(function(a){a in H||(H[a]={id:I,type:"integer"},I++);var b=o[a];H[a].type=g(b,H[a].type),r=h.createElement("attvalue"),r.setAttribute("for",H[a].id),r.setAttribute("value",b),q.appendChild(r)}),C.appendChild(q)),a.renderer){if(n.color){var M;M="#"===n.color[0]?d(n.color):n.color.match(/\d+/g),M.length>2&&(u=h.createElement("viz:color"),u.setAttribute("r",M[0]),u.setAttribute("g",M[1]),u.setAttribute("b",M[2]),M.length>3&&(5===M.length?u.setAttribute("a",M[3]+"."+M[4]):u.setAttribute("a",M[3])),C.appendChild(u))}E=h.createElement("viz:position"),E.setAttribute("x",n[f+"x"]),E.setAttribute("y",-parseInt(n[f+"y"],10)),C.appendChild(E),n.size&&(F=h.createElement("viz:size"),F.setAttribute("value",n[f+"size"]),C.appendChild(F))}B.appendChild(C)}s=h.createElement("attributes"),s.setAttribute("class","node"),Object.keys(H).forEach(function(a){p=h.createElement("attribute"),p.setAttribute("id",H[a].id),p.setAttribute("title",a),p.setAttribute("type",H[a].type),s.appendChild(p)}),x=h.createElement("edges");for(var L=0;L<m.length;L++){if(n=m[L],y=h.createElement("edge"),y.setAttribute("id",n.id),y.setAttribute("source",n.source),y.setAttribute("target",n.target),n.size&&y.setAttribute("weight",n.size),n.label&&y.setAttribute("label",n.label),o=c(n,a.edgeAttributes),o&&(q=h.createElement("attvalues"),Object.keys(o).forEach(function(a){a in J||(J[a]={id:K,type:"integer"},K++);var b=o[a];J[a].type=g(b,J[a].type),r=h.createElement("attvalue"),r.setAttribute("for",J[a].id),r.setAttribute("value",b),q.appendChild(r)}),y.appendChild(q)),a.renderer){if(n.color){var M;M="#"===n.color[0]?d(n.color):n.color.match(/\d+/g),M.length>2&&M.length<=5&&(u=h.createElement("viz:color"),u.setAttribute("r",M[0]),u.setAttribute("g",M[1]),u.setAttribute("b",M[2]),y.appendChild(u))}n.size&&(F=h.createElement("viz:size"),F.setAttribute("value",n.size),y.appendChild(F))}x.appendChild(y)}return t=h.createElement("attributes"),t.setAttribute("class","edge"),Object.keys(J).forEach(function(a){p=h.createElement("attribute"),p.setAttribute("id",J[a].id),p.setAttribute("title",a),p.setAttribute("type",J[a].type),t.appendChild(p)}),z.appendChild(s),z.appendChild(t),z.appendChild(B),z.appendChild(x),D.appendChild(A),D.appendChild(z),h.appendChild(D),j=i.serializeToString(h),a.download&&b(j,"gexf",a.filename),p&&p.parentNode.removeChild(p),q&&q.parentNode.removeChild(q),r&&r.parentNode.removeChild(r),u&&u.parentNode.removeChild(u),v&&v.parentNode.removeChild(v),w&&w.parentNode.removeChild(w),G&&G.parentNode.removeChild(G),E&&E.parentNode.removeChild(E),F&&F.parentNode.removeChild(F),C&&C.parentNode.removeChild(C),y&&y.parentNode.removeChild(y),s&&s.parentNode.removeChild(s),t&&t.parentNode.removeChild(t),B&&B.parentNode.removeChild(B),x&&x.parentNode.removeChild(x),z&&z.parentNode.removeChild(z),A&&A.parentNode.removeChild(A),D&&D.parentNode.removeChild(D),h=null,j}}).call(this);
//# sourceMappingURL=sigma.exporters.gexf.min.js.map