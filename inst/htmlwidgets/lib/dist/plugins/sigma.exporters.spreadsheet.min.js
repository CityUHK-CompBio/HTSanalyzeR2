(function(a){"use strict";function b(a,b,c){var d=null,e=null,f=null;if(window.Blob?(d=new Blob([a],{type:"text/xml"}),e=window.URL.createObjectURL(d)):f="data:text/csv;charset=UTF-8,"+encodeURIComponent(a),navigator.msSaveBlob)navigator.msSaveBlob(d,c);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(d,c);else{var g=document.createElement("a");g.setAttribute("href",window.Blob?e:f),g.setAttribute("download",c||"graph."+b),document.body.appendChild(g),g.click(),document.body.removeChild(g)}e&&setTimeout(function(){window.URL.revokeObjectURL(e)},0)}function c(b,c){return null===b||b===a?c+c:"function"==typeof b?b.toString():(b="string"==typeof b?b:JSON.stringify(b),b=b.replace(/\s+/g," "),c&&c.length?c+b.replace(c,'"'===c?"'":'"')+c:b)}function d(b,c){return null===c||c===a?null:c.split(".").reduce(function(a,b){return a[b]},b)}if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.prototype.toSpreadsheet=function(a){if(a=a||{},a.separator=a.separator||",",a.textSeparator=a.textSeparator||"",a.textSeparator&&'"'!==a.textSeparator&&"'"!==a.textSeparator)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+a.textSeparator);var e,f,g,h,i,j,k=[],l={},m=[],n=0,o=a.categoriesName||"categories";if(!a.what)throw new TypeError('Missing argument: "what".');if("nodes"===a.what)e=a.which?this.graph.nodes(a.which):this.graph.nodes();else{if("edges"!==a.what)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+a.what);e=a.which?this.graph.edges(a.which):this.graph.edges()}l.id=n++,m.push(c("id",a.textSeparator)),"edges"===a.what&&(l.source=n++,m.push(c("source",a.textSeparator)),l.target=n++,m.push(c("target",a.textSeparator))),j=a.categories&&a.categories.length,j&&(l.categories=n++,m.push(c(o,a.textSeparator)));for(var p=0;p<e.length;p++)h=e[p],f=d(h,a.attributes)||{},Object.keys(f).forEach(function(b){b in l||(l[b]=n++,m.push(c(b,a.textSeparator)))});k.push(m);for(var p=0;p<e.length;p++)h=e[p],i=[],i.length=n,i[0]=c(h.id,a.textSeparator),"edges"===a.what&&(i[1]=c(h.source,a.textSeparator),i[2]=c(h.target,a.textSeparator)),j&&(g=d(h,a.categories),Array.isArray(g)&&(g=g.join(",")),i[l.categories]=c(g,a.textSeparator)),f=d(h,a.attributes)||{},Object.keys(f).forEach(function(b){i[l[b]]=c(f[b],a.textSeparator)}),k.push(i);var q=k.map(function(b){return b.join(a.separator)}).join("\n");return a.download&&b(q,"csv",a.filename),q}}).call(this);
//# sourceMappingURL=sigma.exporters.spreadsheet.min.js.map